Please see pdf for implementation details. Thanks
